#Game or whatever idk

#Imports
import os
import json
import random
import platform

#SUPER DUPER IMPORTANT MAIN VARIABLES
userinput = "null"
enemy = None
enemydodgesuccess = False
dodgesuccess = False

#loads objects from json
def importjson(file, name):
    with open(file, "r") as f:
        data = json.load(f)
    globals()[name] = data

#clears console on all  platforms
def clearconsole():
    system = platform.system()
    if system == "Windows":
        os.system("cls")
    else:
        os.system("clear")


#Creating Objects
def loadalljson():
    importjson("./Game/data/player.json", "player")
    importjson("./Game/data/zombie.json", "zombie")
    importjson("./Game/data/George.json", "george")
    importjson("./Game/data/skeleton.json", "skeleton")

#choose ennemy
def selectenemy():
    loadalljson()
    global enemy
    data = [zombie, skeleton]
    enemy = random.choice(data)

selectenemy()

#Draws terminal screen
def draw():
    print(enemy["name"])
    print(enemy["health"],"\n\n\n\n\n")
    print("Your Health: ", player["health"])
    print("__________________________________________________________________")
    print("1. Attack")
    print("2. Dodge")

#Main funtcion where code goes
def main():
    global enemydodgesuccess
    global dodgesuccess
    dodgesuccess = False
    #processing user input
    userinput = input("Option: ")
    match userinput:
        #Exiting Program
        case "0":
            exit(0)
        #Attacking enemy
        case "1":
            if not enemydodgesuccess == True:
                attackvalue = random.randint(1, player["attack"])
                enemy["health"] -= attackvalue
                print("You dealt: ", attackvalue, " damage")
                input("press enter to continue")
            else:
                print(enemy["name"], " dodged attack")
                input("press enter to continue")
        #Dodging
        case "2":
            dodge = random.randint(1, 100)
            if dodge < player["speed"]:
                clearconsole()
                print("you used dodge used dodge...")
                input("press enter to see result")
                print("your dodge failed")
                input("press enter to continue")
                clearconsole()
            else:
                clearconsole()
                print("you used dodge used dodge...")
                input("press enter to see result")
                print("your dodge succeeded")
                input("press enter to continue")
                dodgesuccess = True
                clearconsole()
        #Error Handeling
        case _:
            clearconsole()
            print("Not VALID")
            input("")
            draw()
            main()
    #Checking and updating enemy stats
    enemydodgesuccess = False
    if enemy["health"] == 0 or enemy["health"] < 0:
        print("you defeated the enemy!!")
        input("press enter to continue")
        gameloop()
    else:
        #Enemy Choices
            #setting enemy chances
        enemydodge = random.randint(1, 100)
        enemyattack = random.randint(1, enemy["attack"])
        enemychoices = random.randint(1, 2)
        #Enemy attack
        if enemychoices == 1:
            if dodgesuccess != True:
                clearconsole()
                print(enemy["name"]," dealt ",enemyattack, "damage")
                player["health"] -= enemyattack
                input("press enter to contine")
            else:
                clearconsole()
                print("You dodged ", enemy["name"], "'s attack")
                input("press enter to contine")
        #Enemy dodge
        else:
            if enemydodge != enemy["speed"] or not enemydodge < enemy["speed"]:   
                clearconsole()
                print("enemy used dodge...")
                input("press enter to see result")
                print("enemy dodge failed")
                input("press enter to continue")
   
                clearconsole()
            else:
                clearconsole()
                print("enemy used dodge...")
                input("press enter to see result")
                print("enemy dodge succeded")
                input("press enter to continue")
                clearconsole()
                enemydodgesuccess = True
#Keeps the game running
def gameloop():
    selectenemy()
    while True:
        clearconsole()
        if enemy["health"] < 0 or enemy["health"] == 0:
            print("you defeated the enemy!!")
            input("press enter to continue")
            gameloop()
        elif player["health"] < 0 or player["health"] == 0:
            print("you died...")
            exit(0)
        elif player["health"] == 67.41:
            print ("THE ONE AND ONLY...")
            print("GEORGE FENTDROID")
        else:
            draw()
            main()
            clearconsole()

#init game
gameloop()